# Shop API

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç REST API –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∫–æ—Ä–∑–∏–Ω, –∞ —Ç–∞–∫–∂–µ WebSocket —á–∞—Ç –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º.

---

# üîπ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

## –õ–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ PowerShell:
```powershell
$env:PYTHONPATH="${PWD}\hw"
uvicorn shop_api.main:app --reload
```

## –ß–µ—Ä–µ–∑ Docker Compose:
```powershell
docker compose up --build
```
- –°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8080
- Prometheus –Ω–∞ http://localhost:9090
- Grafana –Ω–∞ http://localhost:3000

# üîπ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ WebSocket —á–∞—Ç–∞

## –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (F12 ‚Üí Console)
–ü–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –∫–æ–º–Ω–∞—Ç–µ test_room
```
const ws = new WebSocket("ws://127.0.0.1:8000/chat/test_room");
ws.onopen = () => console.log("–ü–µ—Ä–≤—ã–π —é–∑–µ—Ä –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è");
ws.onmessage = (event) => console.log(event.data);
```

–í—Ç–æ—Ä–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ —Ç–æ–π –∂–µ –∫–æ–º–Ω–∞—Ç–µ
```
const ws2 = new WebSocket("ws://127.0.0.1:8000/chat/test_room");
ws2.onopen = () => console.log("–í—Ç–æ—Ä–æ–π —é–∑–µ—Ä –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è");
ws2.onmessage = (event) => console.log(event.data);
```

–¢—Ä–µ—Ç–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –¥—Ä—É–≥–æ–π –∫–æ–º–Ω–∞—Ç–µ
```
const ws3 = new WebSocket("ws://127.0.0.1:8000/chat/wrong_room");
ws3.onopen = () => console.log("–¢—Ä–µ—Ç–∏–π —é–∑–µ—Ä –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –≤ –¥—Ä—É–≥—É—é –∫–æ–º–Ω–∞—Ç—É");
ws3.onmessage = (event) => console.log(event.data);
```

–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
```
ws.send("–í—Å–µ–º –≤ –∫–æ–º–Ω–∞—Ç–µ test_room –ø—Ä–∏–≤–µ—Ç –æ—Ç –ø–µ—Ä–≤–æ–≥–æ —é–∑–µ—Ä–∞!"); 
ws.send("–î—Ä—É–∑—å—è, –æ—Ç–ø–∏—à–∏—Ç–µ—Å—å –ø–ª–∏–∑ –∫—Ç–æ –∏ –≤ –∫–∞–∫–æ–π –∫–æ–º–Ω–∞—Ç–µ –ø–æ–ª—É—á–∏–ª –º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ?!"); 
ws2.send("–†–∞–∑-–¥–≤–∞-—Ç—Ä–∏. –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç –æ—Ç –≤—Ç–æ—Ä–æ–≥–æ —é–∑–µ—Ä–∞! –ü–µ—Ä–≤—ã–π, —è –∏–∑ test_room —Ç–µ–±—è —Å–ª—ã—à—É");  
ws3.send("–ê–õ–ï? –≠–¢–û –¢–†–ï–¢–ò–ô –Æ–ó–ï–†. –Ø –ù–ò–ß–ï–ì–û –ù–ï –°–õ–´–®–£. –í–´ –ì–î–ï. –Ø –í wrong_room"); 
ws.send("–í—Ç–æ—Ä–æ–π, –∞ —Ç—ã –Ω–µ –∑–Ω–∞–µ—à—å –≥–¥–µ —Ç—Ä–µ—Ç–∏–π? –ú—ã —Å —Ç–æ–±–æ–π —Ç–æ–ª—å–∫–æ –≤–¥–≤–æ–µ–º —Ç—É—Ç.");
ws2.send("–†–∞–∑-–¥–≤–∞-—Ç—Ä–∏. –ë–µ–∑ –ø–æ–Ω—è—Ç–∏—è.");
```

![–¢–µ—Å—Ç 3 —é–∑–µ—Ä–∞ –∏ 2 —á–∞—Ç–∞](images/websocket_chat_test_3_users_2_rooms.png)

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ Prometheus –∏ Grafana

–°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–∞—à–±–æ—Ä–¥–æ–≤:

Prometheus:
![Prometheus](images/prometheus_target_health.png)

Grafana:
![Grafana](images/grafana_work.png)